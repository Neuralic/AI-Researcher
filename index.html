<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <title>AI Research Agent</title>
  <style>
    *{box-sizing:border-box;margin:0;padding:0;font-family:'Segoe UI',Roboto,Helvetica,Arial,sans-serif}
    body{background:#f5f7fa;color:#1e293b;display:flex;justify-content:center;align-items:flex-start;padding:2rem}
    .container{max-width:720px;width:100%}
    h1{color:#6366f1;margin-bottom:.5rem}
    textarea{width:100%;min-height:100px;border:1px solid #cbd5e1;border-radius:8px;padding:.75rem;font-size:1rem;margin-bottom:1rem;resize:vertical}
    select,button{padding:.6rem 1rem;border:1px solid #cbd5e1;border-radius:8px;font-size:1rem}
    button{background:#6366f1;color:#fff;border:none;cursor:pointer}
    button:hover{background:#4f46e5}
    .loader{display:none;font-style:italic;margin-top:1rem}
    .result{background:#fff;border:1px solid #e2e8f0;border-radius:8px;padding:1.5rem;margin-top:1.5rem;font-size:1rem;line-height:1.6;box-shadow:0 2px 8px rgba(0,0,0,.05)}
    .result h3{color:#6366f1;margin:.5rem 0}
    .result ul{margin-left:1.2em}
    .result strong{font-weight:700}
    .result pre{background:#f1f5f9;border-radius:4px;padding:.5em;overflow-x:auto;font-size:.9em}
    .actions{margin-top:1rem}
    .actions button{margin-right:.5rem}
  </style>
</head>
<body>
  <div class="container">
    <h1>üêê GOAT Research Agent</h1>
    <form id="queryForm">
      <textarea id="query" placeholder="e.g., Effects of AI on WhatsApp" required></textarea>
      <select id="mode">
        <option value="">Auto</option>
        <option value="academic">Academic</option>
        <option value="chaos">Chaos</option>
        <option value="hybrid">Hybrid</option>
      </select>
      <button type="submit">Run</button>
    </form>
    <div id="loader" class="loader">Working‚Ä¶</div>
    <div id="result" class="result" style="display:none;"></div>
    <div id="actions" class="actions" style="display:none;">
      <button onclick="downloadPDF()">üìÑ PDF</button>
      <button onclick="downloadAudio()">üéß Audio</button>
    </div>
  </div>
  <script>
    const form=document.getElementById('queryForm'),loader=document.getElementById('loader'),result=document.getElementById('result'),actions=document.getElementById('actions');let lastContent='';
    form.addEventListener('submit',async e=>{e.preventDefault();loader.style.display='block';result.style.display='none';actions.style.display='none';
      const payload={query:document.getElementById('query').value.trim(),mode_override:document.getElementById('mode').value||undefined};
      try{const res=await fetch('/research',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)});
        const data=await res.json();lastContent=data.content;result.innerHTML=data.content;result.style.display='block';actions.style.display='block';}
      catch(err){result.innerHTML=`<span style="color:red">Error:${err.message}</span>`;result.style.display='block';}
      finally{loader.style.display='none';}
    });
    function downloadPDF(){if(lastContent)window.open(`/pdf?content=${encodeURIComponent(lastContent)}`);}
    function downloadAudio(){if(lastContent)window.open(`/audio?content=${encodeURIComponent(lastContent)}`);}
  </script>
</body>
</html>